{"version":3,"file":"recyclelist.min.js","sources":["../src/recyclelist.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n// jshint unused: true, undef:true\n\n/* eslint-disable no-unused-vars */\n\ndefine(['jquery', 'core/config', 'core/log', 'block_course_recycle/bootstrap-select'], function($, cfg, log, bootstrapselect) {\n\n    var courserecyclelist = {\n\n        init: function() {\n            $(\".recycle-course-edit-handle\").bind('click', this.load_change_form);\n            $(\"#modal-status-save\").bind('click', this.submit_change_form);\n            $(\"#menutopcatid\").bind('change', this.reload_category);\n            $(\"#confirm-selectall-handle\").bind('click', this.select_all);\n            $(\"#confirm-unselectall-handle\").bind('click', this.unselect_all);\n            $(\"#menuchangestatus\").bind('change', this.group_change);\n            log.debug('AMD Course Recycle List initialized');\n        },\n\n        load_change_form: function() {\n\n            var that = $(this);\n\n            var waiter = '<div class=\"centered\"><center><img id=\"detail-waiter\" src=\"';\n            waiter += cfg.wwwroot + '/pix/i/ajaxloader.gif\" /></center></div>';\n            $('#recyclelist-edit-inner-form').html(waiter);\n\n            var id = that.attr('data-course');\n\n            var url = cfg.wwwroot + '/blocks/course_recycle/ajax/services.php';\n            url += '?what=getmodalform';\n            url += '&id=' + id;\n\n            $.get(url, function(data) {\n                $('#recyclelist-edit-inner-form').html(data);\n                $(\"#modal-status-save\").attr('data-course', id);\n                $('.selectpicker').selectpicker();\n            }, 'html');\n        },\n\n        submit_change_form: function() {\n\n            var that = $(this);\n\n            var courseid = that.attr('data-course');\n            var url = cfg.wwwroot + '/blocks/course_recycle/ajax/services.php';\n            url += '?what=changerecycle';\n            url += '&id=' + courseid;\n            var radioname = 'recycleaction';\n            var statusvalue = $('[name='+ radioname +']:checked').val();\n            url += '&status=' + statusvalue;\n            url += '&postactions=' + courserecyclelist.get_postactions_code(statusvalue);\n\n            $.get(url, function(data) {\n                if (data.result === 'success') {\n                    var oldclassname = 'status-' + data.oldstate;\n                    $('.recycle-list-status-' + courseid).removeClass(oldclassname);\n                    var newclassname = 'status-' + data.newstate;\n                    $('.recycle-list-status-' + courseid).addClass(newclassname);\n                    $('#recycle-status-' + courseid).html(data.newlabel);\n                    $('#recyclelist-edit-form').modal('hide'); // Close the modal dialog.\n                }\n            }, 'json');\n        },\n\n        get_status_code: function (statusix) {\n            var statuscodes = [\n                'Ask',\n                'RequestForArchive',\n                'Stay',\n                'Reset',\n                'Clone',\n                'Delete',\n                'Archive',\n                'CloneAndReset',\n                'ArchiveAndDelete',\n                'ArchiveAndReset',\n                'ArchiveAndRetire',\n                'ArchiveCloneAndReset'\n            ];\n\n            return statuscodes[statusix];\n        },\n\n        get_postactions_code: function (statusix) {\n            var postactionscodes = {\n                'Ask': '',\n                'RequestForArchive': '',\n                'Stay': '',\n                'Reset': '',\n                'Clone': '',\n                'Delete': '',\n                'Archive': '',\n                'CloneAndReset': '',\n                'ArchiveAndDelete': 'Delete',\n                'ArchiveAndReset': 'Reset',\n                'ArchiveAndRetire': 'Retire',\n                'ArchiveCloneAndReset': 'CloneAndReset'\n            };\n\n            return postactionscodes[statusix];\n        },\n\n        reload_category: function() {\n            $('#recycle-confirm-category-filter-form').submit();\n        },\n\n        select_all: function() {\n            $('.confirm-select').prop('checked', true);\n        },\n\n        unselect_all: function() {\n            $('.confirm-select').prop('checked', false);\n        },\n\n        group_change: function() {\n            $('#id-groupcommands').submit();\n        }\n\n    };\n\n    return courserecyclelist;\n});"],"names":["define","$","cfg","log","bootstrapselect","courserecyclelist","init","bind","this","load_change_form","submit_change_form","reload_category","select_all","unselect_all","group_change","debug","that","waiter","wwwroot","html","id","attr","url","get","data","selectpicker","courseid","statusvalue","val","get_postactions_code","result","oldclassname","oldstate","removeClass","newclassname","newstate","addClass","newlabel","modal","get_status_code","statusix","submit","prop"],"mappings":"AAmBAA,0CAAO,CAAC,SAAU,cAAe,WAAY,0CAA0C,SAASC,EAAGC,IAAKC,IAAKC,qBAErGC,kBAAoB,CAEpBC,KAAM,WACFL,EAAE,+BAA+BM,KAAK,QAASC,KAAKC,kBACpDR,EAAE,sBAAsBM,KAAK,QAASC,KAAKE,oBAC3CT,EAAE,iBAAiBM,KAAK,SAAUC,KAAKG,iBACvCV,EAAE,6BAA6BM,KAAK,QAASC,KAAKI,YAClDX,EAAE,+BAA+BM,KAAK,QAASC,KAAKK,cACpDZ,EAAE,qBAAqBM,KAAK,SAAUC,KAAKM,cAC3CX,IAAIY,MAAM,wCAGdN,iBAAkB,eAEVO,KAAOf,EAAEO,MAETS,OAAS,8DACbA,QAAUf,IAAIgB,QAAU,2CACxBjB,EAAE,gCAAgCkB,KAAKF,YAEnCG,GAAKJ,KAAKK,KAAK,eAEfC,IAAMpB,IAAIgB,QAAU,2CACxBI,KAAO,qBACPA,KAAO,OAASF,GAEhBnB,EAAEsB,IAAID,KAAK,SAASE,MAChBvB,EAAE,gCAAgCkB,KAAKK,MACvCvB,EAAE,sBAAsBoB,KAAK,cAAeD,IAC5CnB,EAAE,iBAAiBwB,iBACpB,SAGPf,mBAAoB,eAIZgB,SAFOzB,EAAEO,MAEOa,KAAK,eACrBC,IAAMpB,IAAIgB,QAAU,2CACxBI,KAAO,sBACPA,KAAO,OAASI,aAEZC,YAAc1B,EAAE,gCAAkC2B,MACtDN,KAAO,WAAaK,YACpBL,KAAO,gBAAkBjB,kBAAkBwB,qBAAqBF,aAEhE1B,EAAEsB,IAAID,KAAK,SAASE,SACI,YAAhBA,KAAKM,OAAsB,KACvBC,aAAe,UAAYP,KAAKQ,SACpC/B,EAAE,wBAA0ByB,UAAUO,YAAYF,kBAC9CG,aAAe,UAAYV,KAAKW,SACpClC,EAAE,wBAA0ByB,UAAUU,SAASF,cAC/CjC,EAAE,mBAAqByB,UAAUP,KAAKK,KAAKa,UAC3CpC,EAAE,0BAA0BqC,MAAM,WAEvC,SAGPC,gBAAiB,SAAUC,gBACL,CACd,MACA,oBACA,OACA,QACA,QACA,SACA,UACA,gBACA,mBACA,kBACA,mBACA,wBAGeA,WAGvBX,qBAAsB,SAAUW,gBACL,KACZ,qBACc,QACb,SACC,SACA,UACC,WACC,iBACM,oBACG,yBACD,yBACC,8BACI,iBAGJA,WAG5B7B,gBAAiB,WACbV,EAAE,yCAAyCwC,UAG/C7B,WAAY,WACRX,EAAE,mBAAmByC,KAAK,WAAW,IAGzC7B,aAAc,WACVZ,EAAE,mBAAmByC,KAAK,WAAW,IAGzC5B,aAAc,WACVb,EAAE,qBAAqBwC,kBAKxBpC,iBACV"}